
  <button (click)="openCreateModal()">+ New Task</button> <button (click)="openTrashModal()">ğŸ—‘ï¸ Trash</button>
  <app-create-task
  *ngIf="showCreateModal"
  [projectId]="currentProjectId!"
  [members]="projectMembers"
  (optimisticCreate)="addOptimisticTask($event)"
  (close)="closeCreateModal()"
></app-create-task>
<div *ngIf="showTrashModal" class="modal">
  <h3>Deleted Tasks</h3>

  <ul>
    <li *ngFor="let task of trashTasks">
      {{ task.title }}
      <button (click)="restoreTask(task.id)">
        â™»ï¸ Restore
      </button>
    </li>
  </ul>

  <button (click)="closeTrashModal()">Close</button>
</div>
<!-- FILTER CONTROLS -->
<div class="task-filters">
<!-- Status Filter -->
<select
  [value]="filters.status ?? ''"
  (change)="onStatusChange($any($event.target).value)"
>
  <option value="">All Status</option>
  <option value="TODO">Todo</option>
  <option value="IN_PROGRESS">In Progress</option>
  <option value="BLOCKED">Blocked</option>
  <option value="DONE">Done</option>
</select>

<!-- Priority Filter -->
<select
  [value]="filters.priority ?? ''"
  (change)="onPriorityChange($any($event.target).value)"
>
  <option value="">All Priority</option>
  <option value="LOW">Low</option>
  <option value="MED">Medium</option>
  <option value="HIGH">High</option>
  <option value="CRIT">Critical</option>
</select>

<!-- Assignee Filter -->
<select
  [value]="filters.assignee ?? ''"
  (change)="onAssigneeChange($any($event.target).value)"
>
  <option value="">All Assignees</option>
  <option *ngFor="let u of projectMembers" [value]="u.id">
    {{ u.username }}
  </option>
</select>

<button type="button" (click)="clearFilters()">Clear Filters</button>

</div>

<hr />

<!-- TASK LIST -->
 <div *ngIf="isLoadingTasks">Loading tasks...</div>

<div *ngIf="errorMessage" class="error">
  {{ errorMessage }}
</div>
<div *ngIf=" !isLoadingTasks && visibleTasks.length === 0">
  No tasks in this project.
</div>

<ul>
  <li *ngFor="let task of visibleTasks"
  [class.highlight]="task.id === lastUpdatedTaskId">
    <strong>{{ task.title }}</strong>
    â€”
    {{ task.status }}
    â€”
    {{ task.priority }}
    <span *ngIf="task.assigned_username">
      ({{ task.assigned_username }})
    </span>

  <button (click)="openEditModal(task)">Edit</button>

<button
  (click)="deleteTask(task.id)"
  [disabled]="isDeletingTask === task.id"
>
  {{ isDeletingTask === task.id ? 'Deletingâ€¦' : 'Delete' }}
</button>


  </li>
</ul>

<app-edit-task
  *ngIf="showEditModal && editingTask"
  [task]="editingTask"
  [members]="projectMembers"
  (close)="closeEditModal()"
></app-edit-task>
